<%- include('partials/header.ejs') %>

<body class="light-body">
  <!-- Navbar -->
  <nav class="navbar user-navbar">
    <div class="navbar-left">
      <h1 class="brand-title">üìò Vocab Notebook</h1>
    </div>
    <div class="navbar-right">
      <a href="/dashboard" class="nav-link">Home</a>
      <a href="/wordbank" class="nav-link">Word Bank</a>
       <a href="/random" class="nav-link">Random Word</a>
      <a href="/logout" class="nav-link logout-link">Logout</a>
    </div>
  </nav>

  <!-- Search Section -->
  <section class="search-section">
    <form method="POST" action="/search" id="searchForm" onsubmit="return false;" class="search">
      <input class="search-input" type="text" name="word" placeholder="Search for a word..." required />
      <button class="search-btn" type="submit">üîç</button>
    </form>
  </section>

  <!-- Word List -->
  <main class="content">
    <% if (locals.error) { %>
      <div class="alert alert-error"><%= error %></div>
    <% } else if (data) { %>
      <% if (data.length < 1) { %>
        <p class="no-result">No words found.</p>
      <% } else { %>
        <div class="word-results">
          <% data.forEach(word => { %>
            <div class="word-card">
              <p><strong>Word:</strong> <%= word.word %></p>
              <p><strong>Definition:</strong> <%= word.definition %></p>
              <p><strong>Pronunciation:</strong> <%= word.pronunciation %></p>
              <p><strong>Example:</strong> <%= word.example || "‚Äî" %></p>
              <div class="word-actions">
                <!-- Keep delete functionality unchanged -->
                <a href="#" class="delete-btn" data-id="<%= word.id %>" data-name="<%= word.word %>">Delete</a>
              </div>
            </div>
          <% }) %>
        </div>
      <% } %>
    <% } %>
  </main>

  <!-- Delete Confirmation Modal (unchanged) -->
  <div id="deleteModal" class="modal hidden">
    <div class="modal-content">
      <h2>Confirm Delete</h2>
      <p id="delete-message"></p>
      <div class="modal-actions">
        <button id="cancelDelete" type="button" class="btn-secondary">Cancel</button>
        <form id="deleteForm" method="POST">
          <input type="submit" value="Delete" class="btn-danger"/>
        </form>
      </div>
    </div>
  </div>

  <!-- JS Logic -->
  <script>
    // Delete modal logic (unchanged)
    const deleteModal = document.querySelector('#deleteModal');

    document.querySelectorAll('.delete-btn').forEach(btn => {
      btn.addEventListener('click', e => {
        e.preventDefault();
        const wordName = btn.dataset.name;
        const wordId = btn.dataset.id;
        document.querySelector('#delete-message').textContent =
          `Are you sure you want to delete "${wordName}"?`;
        document.querySelector('#deleteForm').action = `/delete/${wordId}`;
        deleteModal.classList.remove('hidden');
      });
    });

    document.querySelector('#cancelDelete').addEventListener('click', () => {
      deleteModal.classList.add('hidden');
    });

    deleteModal.addEventListener('click', e => {
      if (e.target === deleteModal) deleteModal.classList.add('hidden');
    });

    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') deleteModal.classList.add('hidden');
    });

    // Search form submission
    const searchForm = document.querySelector('#searchForm');
    searchForm.addEventListener('submit', e => {
      e.preventDefault();
      const word = searchForm.querySelector('input[name="word"]').value.trim();
      if (word) searchForm.submit();
    });
  </script>
